@{
    ViewData["Title"] = "RAG History";
}

<div class="container mt-4">
    <h2>RAG History</h2>

    <div class="filters mb-3 row">
        <div class="col-md-2">
            <label for="slaFilter">SLA Status</label>
            <select id="slaFilter" class="form-control">
                <option value="">All</option>
                <option value="ok">OK</option>
                <option value="slow">Slow</option>
            </select>
        </div>

        <div class="col-md-2">
            <label for="promptStyleFilter">Prompt Style</label>
            <select id="promptStyleFilter" class="form-control">
                <option value="">All</option>
                <option value="zero-shot">Zero-Shot</option>
                <option value="few-shot">Few-Shot</option>
                <option value="role">Role</option>
                <option value="rag">RAG</option>
                <option value="hybrid">Hybrid</option>
            </select>
        </div>

        <div class="col-md-2">
            <label for="providerFilter">Provider</label>
            <select id="providerFilter" class="form-control">
                <option value="">All</option>
                <option value="OpenAI">OpenAI</option>
                <option value="Gemini">Gemini</option>
                <option value="Claude">Claude</option>
            </select>
        </div>

        <div class="col-md-2">
            <label for="modelFilter">Model</label>
            <select id="modelFilter" class="form-control">
                <option value="">All</option>
                <optgroup label="OpenAI">
                    <option value="gpt-4o-mini">GPT-4o Mini</option>
                    <option value="gpt-4o">GPT-4o</option>
                    <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                </optgroup>
                <optgroup label="Gemini">
                    <option value="gemini-2.0-flash">Gemini 2.0 Flash</option>
                    <option value="gemini-1.5-pro">Gemini 1.5 Pro</option>
                    <option value="gemini-1.5-flash">Gemini 1.5 Flash</option>
                </optgroup>
                <optgroup label="Claude">
                    <option value="claude-3-opus-20240229">Claude 3 Opus</option>
                    <option value="claude-instant">Claude Instant</option>
                </optgroup>
            </select>
        </div>

        <div class="col-md-2">
            <label for="startDate">Start Date</label>
            <input id="startDate" type="date" class="form-control" />
        </div>

        <div class="col-md-2">
            <label for="endDate">End Date</label>
            <input id="endDate" type="date" class="form-control" />
        </div>

        <div class="col-md-4 mt-2">
            <label for="querySearch">Query</label>
            <input id="querySearch" type="text" class="form-control" placeholder="Search queries" />
        </div>
    </div>


    <table id="historyTable" class="table table-striped">
        <thead>
            <tr>
                <th>Query</th>
                <th>PromptStyle</th>
                <th>Provider</th> <!-- ✅ NEW -->
                <th>Model</th>    <!-- ✅ NEW -->
                <th>CreatedAt</th>
                <th>SLA</th>
                <th>Retrieval Latency</th>
                <th>LLM Latency</th>
                <th>Total Latency</th>
            </tr>
        </thead>
    </table>

    <div id="compareResults" class="row mt-4"></div>
</div>

<!-- Details Modal -->
<div class="modal fade" id="historyModal" tabindex="-1">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">RAG History Details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p><strong>Query:</strong> <span id="modalQuery"></span></p>
                <p><strong>PromptStyle:</strong> <span id="modalPromptStyle"></span></p>
                <p><strong>Provider:</strong> <span id="modalProvider"></span></p> <!-- ✅ NEW -->
                <p><strong>Model:</strong> <span id="modalModel"></span></p>       <!-- ✅ NEW -->
                <p><strong>Baseline Answer:</strong></p>
                <pre id="modalBaseline"></pre>
                <p><strong>RAG Answer:</strong></p>
                <pre id="modalRag"></pre>
                <h6>Retrieved Chunks</h6>
                <ul id="modalChunks" class="list-group"></ul>
                <p id="modalLatency"></p>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/rag-history.js"></script>
}
